default:
  label: Label
  cores: 8

pipeline-0:
  preprocess:
    run: True
    key: preprocess-default
  extract:
    run: True
    key: extract-default
  select:
    run: True
    key: select-default
  classify:
    run: True
    key: classify-default
  log:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/runs/mms.0.log

pipeline-1:
  preprocess:
    run: False
    key: preprocess-1
  extract:
    run: False
    key: extract-default
  select:
    run: False
    key: select-1
  classify:
    run: True
    key: classify-default
  log:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/runs/mms.1.log

pipeline-2:
  preprocess:
    run: False
    key: preprocess-default
  extract:
    run: False
    key: extract-default
  select:
    run: False
    key: select-1
  classify:
    run: True
    key: classify-default
  log:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/runs/mms.2.log

preprocess-default:
  input:
    tracks: /Users/jamesmo/projects/sqa-utils/local/data/tracks.h5
    drs: /Users/jamesmo/projects/sqa-utils/local/data/drs.h5
  output:
    tracks: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.preprocess.h5
  only:
    missions: [MMS1, MMS2, MMS3, MMS4]
    drs: [RFI, SC]
  features:
    diff: [CARRIER_SYSTEM_NOISE_TEMP, AGC_VOLTAGE]
  concat: True
  subsample: 1 # N:1 ratio of negative:positive tracks
  log:
    level: info

preprocess-1:
  input:
    tracks: /Users/jamesmo/projects/sqa-utils/local/data/tracks.h5
    drs: /Users/jamesmo/projects/sqa-utils/local/data/drs.h5
  output:
    tracks: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.preprocess.h5
  only:
    missions: [MMS1, MMS2, MMS3, MMS4]
    drs: [RFI, SC]
  features:
    diff: [CARRIER_SYSTEM_NOISE_TEMP, AGC_VOLTAGE]
  concat: True
  subsample: 2 # N:1 ratio of negative:positive tracks
  log:
    level: info

extract-default:
  kind: classification
  window: 5 min
  step: 60 sec
  observations: 60
  tsfresh: [diff_CARRIER_SYSTEM_NOISE_TEMP, diff_AGC_VOLTAGE]
  input:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.h5
    key: concatenated/master
  output:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.h5
    key: concatenated/features
  prompt:
    features: False
  features:
    whitelist:
    blacklist:

select-default:
  drop: [
    SCHEDULE_ITEM_ID,
    GROUND_ANTENNA_ID,
    BEGINNING_OF_TRACK_TIME_DT,
    END_OF_TRACK_TIME_DT,
    TLM_GOOD_FRAME_COUNT,
    TLM_BAD_FRAME_COUNT,
    CAR_TRK_LOOP_LOCK_STATUS,
    AGC_VOLTAGE,
    CARRIER_SYSTEM_NOISE_TEMP
  ]
  split:
    train: '< 2018'
    test: '>= 2018'
  input:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.features.h5
    key: MMS/full
  output:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.features.h5
    key: MMS

select-1:
  drop: [
    SCHEDULE_ITEM_ID,
    GROUND_ANTENNA_ID,
    BEGINNING_OF_TRACK_TIME_DT,
    END_OF_TRACK_TIME_DT,
    TLM_GOOD_FRAME_COUNT,
    TLM_BAD_FRAME_COUNT,
    CAR_TRK_LOOP_LOCK_STATUS,
    AGC_VOLTAGE,
    CARRIER_SYSTEM_NOISE_TEMP
  ]
  split:
    train: '< 2019'
    test: '>= 2019'
  input:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.features.h5
    key: MMS/full
  output:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.features.h5
    key: MMS

classify-default:
  input:
    file: /Users/jamesmo/projects/mloc/timefed/research/dsn/local/data/mms.features.h5
    key: MMS
  RandomForestClassifier:
    random_state: 0
