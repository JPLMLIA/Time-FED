default:
  label: Label
  cores: 42
  log:
    file: c

preprocess-default:
  input:
    tracks: /data1/timefed/local/v3.MRO.tracks.h5
    drs: /data1/timefed/local/v2.drs.h5
  output:
    tracks: /data1/timefed/local/mro/le/preprocess.h5
  only:
    missions: [MRO]
    drs: [LE]
  features:
    diff: [CARRIER_SYSTEM_NOISE_TEMP, ELEVATION_ANGLE, AIR_TEMP, RELATIVE_HUMID]
  concat: False
  log:
    level: info

extract-default:
  kind: classification
  window: 5 min
  step: 60 sec
  observations: 60
  tsfresh: [diff_CARRIER_SYSTEM_NOISE_TEMP, diff_ELEVATION_ANGLE, diff_AIR_TEMP, diff_RELATIVE_HUMID]
  input:
    file: /data1/timefed/local/mro/le/preprocess.h5
    # key: handselected
    key: MRO/master
  output:
    file: /data1/timefed/local/mro/le/features.h5
    key: extract
  prompt:
    features: False
  features:
    whitelist:
    blacklist:

select-default:
  drop: [
    SCHEDULE_ITEM_ID,
    GROUND_ANTENNA_ID,
    DCC_CHANNEL,
    BEGINNING_OF_TRACK_TIME_DT,
    END_OF_TRACK_TIME_DT,
    START_TIME_DT,
    END_TIME_DT,
    TLM_GOOD_FRAME_COUNT,
    TLM_BAD_FRAME_COUNT,
    CAR_TRK_LOOP_LOCK_STATUS,
    CARRIER_SYSTEM_NOISE_TEMP,
    ELEVATION_ANGLE,
    AIR_TEMP,
    RELATIVE_HUMID
  ]
  split:
    train: '< "2013-07"'
    test: '>= "2013-07"'
  input:
    file: /data1/timefed/local/le.features.h5
    key: MRO/handselected
  output:
    file: /data1/timefed/local/le.features.h5
    key: MRO/selected

classify-default:
  input:
    file: /data1/timefed/local/le.features.h5
    key: MRO/selected
  RandomForestClassifier:
    random_state: 0

# -------------------------------------------------------------------------------------------------------------------------
pipeline-pos:
  preprocess:
    run: True
    key: preprocess-pos
  extract:
    run: True
    key: extract-pos
  select:
    run: False
    key: select-default
  classify:
    run: False
    key: classify-default

preprocess-pos:
  input:
    tracks: /data1/timefed/local/v3.MRO.tracks.h5
    drs: /data1/timefed/local/v2.drs.h5
  output:
    tracks: /data1/timefed/local/mro/le/pos.preprocess.h5
  only:
    missions: [MRO]
    drs: [LE]
  features:
    diff: [CARRIER_SYSTEM_NOISE_TEMP, ELEVATION_ANGLE, AIR_TEMP, RELATIVE_HUMID]
  subsample:
    neg_limit: 0
    query: (2010 <= index) & (index < 2013)
  concat: False
  log:
    level: info

extract-pos:
  kind: classification
  window: 5 min
  step: 60 sec
  observations: 60
  tsfresh: [diff_CARRIER_SYSTEM_NOISE_TEMP, diff_ELEVATION_ANGLE, diff_AIR_TEMP, diff_RELATIVE_HUMID]
  input:
    file: /data1/timefed/local/mro/le/pos.preprocess.h5
    # key: handselected
    key: MRO/master
    # key: positives
  output:
    file: /data1/timefed/local/mro/le/pos.features.h5
    key: extract
  prompt:
    features: False
  features:
    whitelist:
    blacklist:

# -------------------------------------------------------------------------------------------------------------------------
pipeline-neg:
  preprocess:
    run: True
    key: preprocess-neg
  extract:
    run: True
    key: extract-neg
  select:
    run: False
    key: select-default
  classify:
    run: False
    key: classify-default

preprocess-neg:
  input:
    tracks: /data1/timefed/local/v3.MRO.tracks.h5
    drs: /data1/timefed/local/v2.drs.h5
  output:
    tracks: /data1/timefed/local/mro/le/neg.preprocess.h5
  only:
    missions: [MRO]
    drs: [LE]
  features:
    diff: [CARRIER_SYSTEM_NOISE_TEMP, ELEVATION_ANGLE, AIR_TEMP, RELATIVE_HUMID]
  subsample:
    pos_limit: 0
    query: (2010 <= index) & (index < 2013)
  concat: False
  log:
    level: info

extract-neg:
  kind: classification
  window: 5 min
  step: 60 sec
  observations: 60
  tsfresh: [diff_CARRIER_SYSTEM_NOISE_TEMP, diff_ELEVATION_ANGLE, diff_AIR_TEMP, diff_RELATIVE_HUMID]
  input:
    file: /data1/timefed/local/mro/le/neg.preprocess.h5
    # key: handselected
    key: MRO/master
    # key: negatives
  output:
    file: /data1/timefed/local/mro/le/neg.features.h5
    key: extract
  prompt:
    features: False
  features:
    whitelist:
    blacklist:
